# 華友聯健康園區網站 - 功能清單

## 已完成功能 ✓

- [x] 首頁設計與實作（Hero Section、六大面向、健康醫療、休閒農場、生活服務）
- [x] 導航欄設計（桌面版與手機版）
- [x] 頁尾設計（包含完整導航連結、聯絡資訊、訂閱功能）
- [x] 關於園區頁面
- [x] 六大面向頁面
- [x] 健康醫療頁面
- [x] 休閒農場頁面
- [x] 生活服務頁面
- [x] 介紹影片頁面（含精選圖庫）
- [x] 聯絡我們頁面（含預約表單）
- [x] 所有圖片本地化（台灣人物）
- [x] 背景音樂系統整合
- [x] 手機選單優化（透明背景、金色文字光暈、無圖示）
- [x] 品牌名稱改為中文「華友聯健康園區」並加入光暈效果
- [x] 導航欄品牌按鈕加入金色發光邊框效果
- [x] 奢華生活風格影片加入背景音樂
- [x] Footer 完整導航連結與視覺增強
- [x] 資料庫整合（MySQL/TiDB with Drizzle ORM）
- [x] 使用者認證系統（Manus OAuth）
- [x] S3 儲存整合
- [x] tRPC API 架構

## 準備發布

- [x] 最終測試與驗證
- [x] 導航欄品牌按鈕懸停效果增強（金色光暈、微縮放）
- [ ] 建立 checkpoint
- [ ] 發布至生產環境

## 新增需求

- [x] 移除首頁「探索園區」按鈕並優化 Hero Section 視覺設計

## 文章管理系統（CMS）

- [x] Google OAuth 登入整合（導航欄登入按鈕）
- [x] 管理員權限系統（允許名單）
- [x] 文章資料庫 Schema 設計
- [x] 文章 CRUD API（新增、讀取、更新、刪除）
- [x] 文章列表頁面（前台顯示）
- [x] 文章詳情頁面
- [x] 文章管理後台介面
- [x] 安裝並配置 Tiptap 富文本編輯器
- [x] 創建文章編輯器頁面（/admin/article/new 和 /admin/article/:id）
- [x] 實作圖片上傳到 S3 功能
- [x] 創建允許名單管理介面（/admin/authors）
- [x] 在導航欄添加「文章」連結

## CMS 優化功能

- [x] 文章搜尋功能（即時搜尋標題和內容）
- [x] 文章分類篩選功能
- [x] 草稿自動儲存機制（每30秒）
- [x] 編輯器增強：表格支援
- [x] 編輯器增強：程式碼區塊支援
- [x] 編輯器增強：影片嵌入支援
- [x] 編輯器增強：YouTube/Vimeo 嵌入支援

## CMS 進階功能

### 文章標籤系統
- [x] 建立 tags 資料表
- [x] 建立 article_tags 關聯表（多對多）
- [x] 標籤 CRUD API
- [x] 文章編輯器中的標籤選擇器
- [x] 前台標籤雲導航
- [x] 按標籤篩選文章

### 排程發布功能
- [x] 新增 scheduledPublishAt 欄位到 articles 表
- [x] 排程發布日期時間選擇器
- [ ] 後台排程文章列表
- [ ] 自動發布機制（定時檢查）

### SEO 優化
- [x] 新增 metaDescription 欄位
- [x] 新增 metaKeywords 欄位
- [x] 新增 ogImage 欄位
- [x] SEO 欄位編輯介面
- [x] 文章詳情頁 meta tags 渲染

### 系統優化檢視項目
- [x] 行動裝置 RWD 檢查
- [x] 編輯器效能優化
- [x] 圖片上傳進度顯示
- [x] 錯誤處理與使用者回饋
- [x] 權限控制完整性檢查

## 新增進階功能

### 排程發布自動化
- [x] 建立後端定時任務服務
- [x] 每分鐘檢查 scheduledPublishAt 欄位
- [x] 自動將到期文章改為已發布狀態
- [x] 記錄自動發布日誌

### 文章預覽功能
- [x] 編輯器新增預覽按鈕
- [x] 建立預覽頁面路由
- [x] 預覽頁面顯示文章實際樣式
- [x] 支援草稿預覽（不需發布）

### 後台 Dashboard
- [x] 建立 Dashboard 頁面
- [x] 文章統計卡片（總數、草稿、已發布）
- [x] 本月新增文章趋勢
- [x] 快速操作區（新增文章、查看文章）
- [x] 最近編輯文章列表

## 導覽欄調整

- [x] 移除導覽欄的「文章」連結
- [x] 新增「管理登入」按鈕（管理員入口）
- [x] 登入後顯示使用者資訊與後台連結
- [x] 優化桌面版導覽欄排版
- [x] 優化手機版導覽欄排版（漢堡選單）
- [x] 確保所有頁面導覽欄一致性

## 文章與頁面區域關聯系統

### 系統分析與規劃
- [x] 分析所有現有頁面與區域
- [x] 定義區域類型（首頁、關於我們、六大面向等）
- [x] 設計文章與區域的多對多關係

### 資料庫與 API
- [ ] 建立 page_sections 資料表
- [ ] 建立 article_sections 關聯表
- [ ] 新增區域管理 API
- [ ] 修改文章 API 支援區域篩選

### 編輯器功能
- [ ] 編輯器新增區域選擇器（多選）
- [ ] 顯示已選區域列表
- [ ] 儲存時同步更新關聯

### 前台顯示
- [ ] 首頁顯示「最新消息」區域文章
- [ ] 各頁面顯示對應區域文章
- [ ] 區域文章列表組件

## 文章區域系統進度更新

### 已完成
- [x] 分析所有現有頁面與區域
- [x] 定義區域類型（首頁、關於我們、六大面向等）
- [x] 設計文章與區域的多對多關係
- [x] 建立 page_sections 資料表
- [x] 建立 article_sections 關聯表
- [x] 插入 21 個預設區域資料
- [x] 新增區域管理 API (getSections, getArticleSections, setArticleSections)
- [x] 編輯器新增區域選擇器（多選）
- [x] 顯示已選區域列表
- [x] 儲存時同步更新關聯

### 待完成
- [ ] 首頁顯示「最新消息」區域文章
- [ ] 各頁面顯示對應區域文章
- [ ] 建立通用區域文章列表組件

## 音樂雙重播放問題

- [x] 檢查 BackgroundMusic 組件實作
- [x] 檢查 App.tsx 組件掛載情況
- [x] 檢查是否有 React StrictMode 導致雙重渲染
- [x] 檢查音樂組件是否被多次引入
- [x] 修復根本原因（影片音軌 + 背景音樂衝突）
- [x] 測試驗證修復效果

## 專案打包與部署文件

- [x] 撰寫完整部署指南（DEPLOYMENT.md）
- [x] 撰寫專案架構說明文件
- [x] 準備環境變數範本檔案（ENV_VARIABLES.md）
- [x] 撰寫資料庫遷移指南
- [x] 撰寫常見問題排除文件
- [x] 打包專案原始碼（668 MB, 446 個檔案）
- [x] 驗證打包完整性
- [x] 準備交付檔案

## 音樂多重播放問題 - 全面排查

- [x] 檢查 BackgroundMusic 組件是否被多次實例化
- [x] 檢查所有頁面是否有重複的音訊元素
- [x] 檢查 useEffect 依賴項是否導致重複執行
- [x] 檢查 audio 元素是否有重複建立
- [x] 使用瀏覽器開發工具檢查實際 DOM 中的 audio 元素數量
- [x] 檢查 React 組件掛載/卸載生命週期
- [x] 修復所有發現的問題（重寫 BackgroundMusic 組件）
- [x] 驗證修復效果（無法重現問題，見 AUDIO_DEBUG_REPORT.md）

## 重新實作失敗的功能

- [x] 重新實作 BackgroundMusic 組件修復（使用 new Audio()）
- [x] 確認文章頁面區域系統資料庫 Schema
- [x] 確認文章頁面區域系統 API 端點
- [x] 確認文章編輯器區域選擇器
- [x] 測試所有功能（7 個測試全部通過）
- [ ] 建立新的可發佈 checkpoint

## Checkpoint 發布問題診斷

- [x] 檢查當前 git commit 狀態
- [x] 檢查遠端儲存庫同步狀態
- [x] 檢查 checkpoint 版本記錄
- [x] 分析 UI 顯示邏輯
- [x] 撰寫完整診斷報告（見 CHECKPOINT_PUBLISHING_DIAGNOSIS.md）
- [x] 提供解決方案

## 專案特有問題深入診斷

- [ ] 檢查 .git 目錄狀態
- [ ] 檢查 git 配置檔
- [ ] 檢查異常分支（backup, rebase, create_ckpt 等）
- [ ] 清理異常分支
- [ ] 重置 git 狀態到乾淨狀態
- [ ] 嘗試建立新 checkpoint
- [ ] 驗證發佈功能

## 介紹影片頁面更新

- [x] 在 hero 區下方嵌入 YouTube 影片 (https://youtu.be/Oon-NlRMk1M)
- [x] 設計響應式影片容器
- [x] 測試影片播放功能
